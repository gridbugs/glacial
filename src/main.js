import './populate_namespaces.js';

import {initGlobals} from './globals.js';

import {GlobalDrawer} from './global_drawer.js';
import {Tiles} from './tiles.js';

import {StringTerrainGenerator} from './string_terrain_generator.js';
import {EcsContext} from './ecs_context.js';

import {Renderer} from './renderer.js';

export async function main() {
    await initGlobals();

    var terrainStringArray = [
'&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&',
'&                                               &             &',
'&  &             &   &  &&               &                    &',
'&   &      &         & &        ######################    &&  &',
'&    &                          #....................#     && &',
'&      &      ###################....................#      &&&',
'&      &      #........#........#....................#        &',
'& &   &       #........#........#....................#  &     &',
'&             #........#........#....................#   &    &',
'& &           #.................#........@...........+        &',
'&             #........#........#..>.................#      & &',
'&     #############.####........#....................#   &    &',
'&     #................#.............................#        &',
'&   & #.........................#....................#        &',
'&     #................#........#....................#  &     &',
'&     #................#........#....................#        &',
'&  &  .................#........#....................#  &     &',
'&     #................#........#....................#      & &',
'&  &  #................###############.###############        &',
'&     #................#...................#                  &',
'&     #................#...................#               &  &',
'&     ##################...................#                  &',
'&                      #...................#          &       &',
'&   & &  &             #....................      &       &   &',
'&         &            #...................#       &  &   &   &',
'&    &&  & &        &  #...................#        &         &',
'&     &    &        &  #...................#              &   &',
'&      &    &&&        #####################              &   &',
'&                                                             &',
'&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&',
    ];

    var generator = new StringTerrainGenerator(terrainStringArray);
    var ecs = new EcsContext();

    generator.generate(ecs);

    var renderer = new Renderer(ecs, GlobalDrawer.Drawer);
    renderer.run();
}
